# Lab 02: Forensic Analysis and File Recovery with Autopsy

## üìã Lab Overview

This lab demonstrates advanced digital forensic analysis using Autopsy, focusing on file carving, deleted file recovery, and multi-drive examination. The investigation simulates a real-world scenario where a company president (Bob) needs specific images recovered from both active and deleted storage areas across multiple disk images.

**Lab Focus:** Forensic File Analysis, Deleted File Recovery, File Carving, Multi-Source Investigation

**Case Scenario:** Robert (Bob), the company president, requires assistance recovering accidentally deleted flower photos from a MacOS hard drive while also identifying all bearcat images across the primary system for organizational purposes.

---

## üéØ Objectives

By completing this lab, I demonstrated proficiency in:

- Creating forensically sound disk images using Guymager
- Conducting comprehensive forensic analysis using Autopsy
- Recovering deleted files from unallocated space using file carving techniques
- Analyzing multiple disk images within a single investigation
- Identifying files hidden in various formats (compressed archives, embedded documents, email attachments)
- Understanding file system artifacts and metadata significance
- Differentiating between active and deleted files using timestamps
- Working with multiple file formats and extraction techniques
- Documenting findings in a professional forensic report format

---

## üõ†Ô∏è Tools & Environment

### Primary Tools
- **Guymager** - Forensic disk imaging tool
- **Autopsy 4.x** - Open-source digital forensics platform
- **Linux-based Forensic Workstation** - Investigation environment

### Supporting Tools
- **Thunderbird Mail** - Email file (.eml) viewer
- **Archive Extractors** - For compressed file analysis (tar.xz)
- **Document Viewers** - PDF and presentation file analysis
- **Image Viewers** - Various format support

### File Systems Analyzed
- **Primary Hard Drive** - Linux/Unix file system
- **MacOS Hard Drive** (macwd.E01) - Apple HFS+/APFS file system

---

## üìä Investigation Summary

### Case Details

**Client:** Robert (Bob), Company President  
**Request:** 
1. Locate all bearcat images on primary hard drive
2. Recover accidentally deleted flower photos from MacOS hard drive

**Evidence Sources:**
- Primary Hard Drive (Linux-based system)
- Secondary MacOS Hard Drive Image (macwd.E01)

**MD5 Hash of Primary Drive:** `06c53213dd669b2b7cfa93714fe3943e`

### Final Results

**Bearcat Images Found:** 11 total
- Active files: 9
- Deleted/carved files: 2
- Hidden in various formats: PDF, email attachments, compressed archives, presentations, video files

**Deleted Flower Photos Recovered:** 5 total
- All recovered from MacOS drive unallocated space
- Formats: JPG, BMP, GIF, PNG, PCX
- All confirmed deleted (Modified timestamp = 0)

---

## üîç Methodology & Detailed Analysis

### Phase 1: Evidence Acquisition

#### Step 1: Forensic Imaging with Guymager

**Objective:** Create a forensically sound copy of the original hard drive

**Process:**
1. Connected source drive to forensic workstation
2. Launched Guymager for disk imaging
3. Selected source device and configured imaging parameters
4. Generated Expert Witness Format (.E01) image
5. Calculated MD5 hash for verification

**Hash Verification:**
- **MD5 Hash Generated:** `06c53213dd669b2b7cfa93714fe3943e`
- **Integrity Status:** ‚úÖ Verified - Image matches original source

**Why This Matters:**
Creating a forensic image preserves the original evidence in its pristine state. Working on the duplicate ensures:
- Original evidence remains unmodified
- Chain of custody is maintained
- Multiple examinations can be performed
- Evidence is legally admissible in court

---

### Phase 2: Case Initialization in Autopsy

#### Step 2: Creating New Forensic Case

**Case Setup:**
```
Case Name: Bob_Investigation
Case Number: [Generated by Autopsy]
Examiner: Faraz Ahmed
Organization: [Your Organization]
```

**Data Source Configuration:**
1. Added primary hard drive image as initial data source
2. Configured ingest modules for automated analysis
3. Selected analysis options:
   - File type identification
   - Hash calculation
   - Keyword search
   - Email parsing
   - Embedded file extraction
   - **File carving for deleted files**

**Ingest Modules Enabled:**
- Recent Activity
- Hash Lookup
- File Type Identification
- Extension Mismatch Detector
- Embedded File Extractor
- Email Parser
- PhotoRec Carver (for deleted file recovery)

**Why These Modules Matter:**
These modules automate the detection of:
- Files with mismatched extensions (attempts to hide files)
- Embedded files within other files
- Deleted files in unallocated space
- Email attachments and artifacts
- Recently accessed files and user activity

---

### Phase 3: Primary Hard Drive Analysis

#### File System Structure Examined

```
Primary Drive Root/
‚îú‚îÄ‚îÄ Desktop/
‚îú‚îÄ‚îÄ Documents/
‚îú‚îÄ‚îÄ Downloads/
‚îú‚îÄ‚îÄ Music/
‚îú‚îÄ‚îÄ Pictures/
‚îú‚îÄ‚îÄ topo/
‚îú‚îÄ‚îÄ bearcat.png (Root level)
‚îú‚îÄ‚îÄ NotanImage.svg (Root level)
‚îî‚îÄ‚îÄ $CarvedFiles/ (Autopsy-generated)
```

#### Root Level Findings

**Bearcat Image #1: bearcat.png**
- **Location:** Root directory
- **File Type:** PNG image
- **Status:** Active file
- **Significance:** Openly accessible bearcat image
- **Analysis:** Standard image file, no obfuscation

**Bearcat Image #2: NotanImage.svg**
- **Location:** Root directory
- **File Type:** SVG (Scalable Vector Graphics)
- **Status:** Active file
- **Interesting Note:** Filename suggests possible misdirection, but contains legitimate bearcat image
- **Analysis:** Vector format image, viewable in modern browsers

---

#### $CarvedFiles Analysis (Root Level)

**What is $CarvedFiles?**
This is a special directory created by Autopsy's file carving module. It contains files recovered from unallocated space‚Äîareas of the disk where files were previously deleted but data blocks haven't been overwritten yet.

**Deleted Files Recovered:**

**Bearcat Image #5 (Carved)**
- **Location:** $CarvedFiles/
- **File Type:** Image file (carved from unallocated space)
- **Status:** DELETED
- **Modified Timestamp:** 0 (indicates deletion)
- **Significance:** User cannot access this file through normal means
- **Recovery Method:** File carving based on file signature/header detection

**Forensic Insight:** Modified time of 0 is a strong indicator of file deletion. The file system has removed the directory entry, but the actual data blocks remain on disk until overwritten.

**Bearcat Image #6 (Carved)**
- **Location:** $CarvedFiles/
- **File Type:** Image file (carved from unallocated space)
- **Status:** DELETED
- **Modified Timestamp:** 0
- **Analysis:** Similar to Bearcat Image #5, recovered through PhotoRec carving

**Key Learning:** File carving demonstrates that "deleting" a file doesn't actually erase the data‚Äîit simply marks the space as available for reuse. This is crucial for digital forensics investigations.

---

#### Desktop Folder Analysis

**Bearcat Image #8: _D.pedeef**
- **Location:** Desktop/
- **Actual File Type:** PDF document (despite unusual extension)
- **Obfuscation Level:** Medium
- **Status:** Active file
- **Extraction Method:** Opened PDF, navigated to page 2, extracted embedded bearcat image
- **File Extension Mismatch:** Yes - .pedeef is non-standard for PDF

**Forensic Technique Used:**
1. Identified file type through magic bytes/header analysis
2. Opened with PDF viewer despite unusual extension
3. Located bearcat image on second slide/page
4. Extracted and saved image separately

**Why This Matters:** Files can be hidden by changing extensions. Forensic tools identify files by their actual content (file signatures/magic bytes), not just extensions.

**Meeting Notes Email: meeting_notes.eml**
- **Location:** Desktop/
- **File Type:** Email message file
- **Viewer Used:** Thunderbird Mail
- **Status:** Active file

**Bearcat Image #3 (Email Attachment)**
- **Extraction Context:** Embedded in email message
- **Analysis:** Pre-composed email with attached bearcat image
- **Content:** Professional email template with bearcat graphic
- **Forensic Significance:** Emails can contain critical evidence in attachments, metadata (sender/receiver info), and timestamps

**macwd.E01 - Secondary Evidence**
- **Location:** Desktop/
- **File Type:** Expert Witness Format disk image (MacOS hard drive)
- **Purpose:** Contains accidentally deleted flower photos
- **Analysis:** Requires separate mounting as additional data source
- **Note:** This becomes Phase 4 of our investigation

---

#### Documents Folder Analysis

**Bearcat Image #7: .hidden.jpeg**
- **Location:** Documents/
- **File Type:** JPEG image
- **Status:** Active but hidden (leading dot in Unix/Linux hides files)
- **Significance:** Demonstrates use of file system features to obscure files
- **Visibility:** Not shown in standard directory listings without -a flag

**Forensic Technique:** Hidden files (starting with .) are standard in Unix/Linux but may be used to conceal evidence. Autopsy shows all files regardless of hidden attributes.

**Bearcat Image #9: week1.odp**
- **Location:** Documents/
- **File Type:** OpenDocument Presentation (LibreOffice/OpenOffice)
- **Status:** Active file
- **Extraction Method:** Opened presentation, located bearcat image on slide 2, saved separately
- **Analysis:** Images embedded in presentations are stored within the document's internal ZIP structure

**Technical Detail:** .odp files are actually ZIP archives containing XML and media files. This explains why embedded images persist even when the presentation is closed.

---

#### Downloads Folder Analysis

**Bearcat Image #4: ahhhhhhh**
- **Location:** Downloads/
- **File Type:** Image file (no extension)
- **Extension Mismatch:** Yes - file has no extension despite being valid image
- **Status:** Active file
- **Analysis:** File type identified through content analysis, not extension

**Forensic Insight:** Files without extensions can still be identified and opened by analyzing their file headers (magic bytes).

**Bearcat Image #1 (Compressed Archive): cute.tar.xz**
- **Location:** Downloads/
- **File Type:** Compressed TAR archive with XZ compression
- **Status:** Active file
- **Extraction Process:**
  1. Identified as compressed archive (.tar.xz)
  2. Used archive extraction tool to decompress
  3. Extracted bearcat image from inside archive
  4. Verified image integrity

**Compression Analysis:**
- `.tar` = Tape Archive (packaging multiple files)
- `.xz` = XZ compression algorithm (high compression ratio)
- Combined = .tar.xz (compressed archive)

**Why Relevant:** Suspects often hide files in nested archives thinking they won't be examined. Forensic tools can recursively extract and analyze archive contents.

---

#### Music Folder Analysis

**Bearcat Image #10: Tutorial.mp4**
- **Location:** Music/
- **File Type:** MP4 video file
- **Status:** Active file
- **Unusual Placement:** Video file stored in Music folder (potential misfiling or intentional obscurity)
- **Extraction Method:** 
  1. Opened MP4 file
  2. Captured frame containing bearcat image
  3. Converted video frame to JPG format
  4. Saved as separate image file

**Forensic Technique - Video Frame Extraction:**
Video files are sequences of images (frames). Each frame can be extracted as a still image, making videos a potential hiding place for static content.

**Metadata Considerations:**
- Video creation timestamp
- Camera/device information
- GPS coordinates (if available)
- Edit history

---

### Phase 4: MacOS Hard Drive Analysis (macwd.E01)

#### Step 3: Adding Secondary Data Source

**Process:**
1. Selected "Add Data Source" in Autopsy
2. Located macwd.E01 in Desktop folder of primary drive
3. Configured ingest modules (especially file carving for deleted files)
4. Initiated analysis of MacOS disk image

**Why Separate Analysis:**
The MacOS drive is a complete separate file system requiring its own processing. Mounting it as an additional data source allows Autopsy to:
- Parse MacOS-specific file systems (HFS+/APFS)
- Apply file carving to unallocated space
- Maintain separate evidence chains

---

#### MacOS File System Structure

```
macwd.E01/
‚îú‚îÄ‚îÄ vol0/
‚îú‚îÄ‚îÄ vol1/
‚îú‚îÄ‚îÄ vol3/ (Active flower photos - NOT deleted)
‚îú‚îÄ‚îÄ vol4/ (Active flower photos - NOT deleted)
‚îú‚îÄ‚îÄ vol5/
‚îú‚îÄ‚îÄ vol6/
‚îú‚îÄ‚îÄ vol7/
‚îú‚îÄ‚îÄ vol8/
‚îÇ   ‚îî‚îÄ‚îÄ $CarvedFiles/ (DELETED FLOWER PHOTOS HERE)
‚îú‚îÄ‚îÄ vol9/
‚îú‚îÄ‚îÄ vol10/
‚îî‚îÄ‚îÄ vol11/
```

**Volume Analysis:**

**vol3 & vol4:**
- Contained active (non-deleted) flower photos
- Also contained other miscellaneous photos
- **Excluded from report** - Client only needs deleted photos recovered

**vol8 - Critical Evidence Location:**
- Contains $CarvedFiles directory
- **All deleted flower photos recovered here**
- File carving successfully recovered files from unallocated space

---

#### Deleted Flower Photo Recovery Results

**Total Deleted Flower Photos Recovered:** 5

**Flower Image #1: f0007454.gif**
- **Format:** GIF (Graphics Interchange Format)
- **Location:** vol8/$CarvedFiles/
- **Status:** DELETED (Modified timestamp = 0)
- **Recovery Method:** File carving from unallocated space
- **MD5 Hash:** [Unique hash value]
- **File Size:** [Size from metadata]
- **Significance:** Successfully recovered despite deletion

**Flower Image #2: f0002628.bmp**
- **Format:** BMP (Bitmap)
- **Location:** vol8/$CarvedFiles/
- **Status:** DELETED (Modified timestamp = 0)
- **Recovery Method:** File carving
- **MD5 Hash:** [Unique hash - different from f0007454.gif]
- **Analysis:** Different hash confirms this is a unique image despite visual similarity

**Visual Similarity Analysis:**
Images f0007454.gif, f0002628.bmp, and f0009688.png may appear visually similar to the human eye, but their hash values confirm they are distinct files. This could indicate:
- Same flower photographed multiple times
- Same image converted to different formats
- Slightly different crops or edits

**Flower Image #3: f0000575.jpg**
- **Format:** JPEG
- **Location:** vol8/$CarvedFiles/
- **Status:** DELETED (Modified timestamp = 0)
- **Recovery Method:** File carving
- **Quality:** Standard JPEG compression
- **Significance:** Most common image format, easily recoverable

**Flower Image #4: f0009688.png**
- **Format:** PNG (Portable Network Graphics)
- **Location:** vol8/$CarvedFiles/
- **Status:** DELETED (Modified timestamp = 0)
- **Recovery Method:** File carving
- **MD5 Hash:** [Unique hash - different from similar-looking images]
- **Analysis:** Lossless compression format, maintains higher quality

**Flower Image #5: f0007714.pcx**
- **Format:** PCX (PC Paintbrush)
- **Location:** vol8/$CarvedFiles/
- **Status:** DELETED (Modified timestamp = 0)
- **Recovery Method:** File carving
- **Challenge:** Legacy format requiring specific software to view
- **Viewer Availability:** Not installed on current VMware workstation
- **Confirmation:** File header/signature confirms it's an image file
- **Resolution:** Can be opened with specialized viewers or converted to modern formats

**About PCX Format:**
- Developed by ZSoft Corporation for PC Paintbrush
- One of the first widely-used bitmap image formats for DOS/Windows
- Largely obsolete today, replaced by PNG and JPEG
- Still recoverable through file carving based on unique file signature

**Recommendation for Client:** Convert PCX to PNG or JPEG for long-term accessibility

---

### Hash Value Analysis - Proving File Uniqueness

**Why Hash Values Matter:**

When examining the three visually similar flower images (f0007454.gif, f0002628.bmp, f0009688.png), I verified they were distinct files by comparing their MD5 hash values:

```
f0007454.gif: [Hash A]
f0002628.bmp: [Hash B]  
f0009688.png: [Hash C]

If Hash A ‚â† Hash B ‚â† Hash C, then files are different
```

**Result:** All three hashes were different, confirming these are unique images despite visual similarity.

**Forensic Significance:**
- Proves these aren't duplicate copies
- Each represents a separate piece of evidence
- Could be same flower from different angles, different compression, or different edit states
- All three must be preserved and documented separately

---

## üìà Technical Skills Demonstrated

### File Carving & Recovery
- Successfully recovered 7 deleted files (2 bearcats, 5 flowers)
- Understood unallocated space and how deleted files persist
- Interpreted timestamp metadata (Modified time = 0 indicates deletion)
- Distinguished between active and deleted files

### Multi-Format File Analysis
- **Compressed Archives:** tar.xz extraction
- **Email Files:** .eml parsing with Thunderbird
- **Documents:** PDF and ODP presentation analysis
- **Images:** PNG, JPEG, SVG, GIF, BMP, PCX
- **Video:** MP4 frame extraction
- **Disk Images:** E01 format mounting and analysis

### File System Analysis
- Navigated Linux/Unix file structures
- Analyzed MacOS HFS+/APFS volumes
- Understood hidden files (leading dot notation)
- Interpreted volume structures (vol0-vol11)

### Forensic Tool Proficiency
- **Guymager:** Disk imaging with hash verification
- **Autopsy:** Comprehensive forensic analysis platform
- **Ingest Modules:** Automated evidence detection
- **File Carving:** PhotoRec integration for deleted file recovery

### Evidence Documentation
- Maintained detailed chain of custody
- Documented all findings with screenshots
- Tracked file locations and recovery methods
- Generated hash values for integrity verification

---

## üîê Forensic Best Practices Applied

### Evidence Preservation
‚úÖ Created forensic image before analysis  
‚úÖ Generated and verified MD5 hash of source drive  
‚úÖ Worked only on duplicate copy, never original evidence  
‚úÖ Maintained original evidence in pristine condition  

### Comprehensive Analysis
‚úÖ Examined all folders and volumes systematically  
‚úÖ Used multiple ingest modules for thorough scanning  
‚úÖ Recovered deleted files from unallocated space  
‚úÖ Analyzed files hidden in various formats  
‚úÖ Documented both active and deleted files  

### File Identification
‚úÖ Identified files by content (magic bytes), not just extensions  
‚úÖ Detected extension mismatches (_D.pedeef)  
‚úÖ Found hidden files (leading dot notation)  
‚úÖ Extracted embedded files from containers  
‚úÖ Verified file uniqueness through hash comparison  

### Multi-Source Investigation
‚úÖ Analyzed primary and secondary disk images  
‚úÖ Properly mounted additional data sources  
‚úÖ Maintained separate evidence chains for each source  
‚úÖ Cross-referenced findings across multiple drives  

### Professional Reporting
‚úÖ Created detailed summary report  
‚úÖ Included comprehensive appendix with all evidence  
‚úÖ Documented hash values for verification  
‚úÖ Provided screenshots of all significant findings  
‚úÖ Categorized findings by evidence type and location  

---

## üí° Key Findings & Analysis

### Finding #1: Diverse Hiding Techniques Observed

Files were concealed using multiple methods:
- **Compression:** cute.tar.xz archive
- **Embedding:** Images in PDFs and presentations
- **Email Attachments:** meeting_notes.eml
- **Hidden Attributes:** .hidden.jpeg
- **Extension Manipulation:** _D.pedeef, files without extensions
- **Wrong Location:** Video in Music folder
- **File Format Obscurity:** PCX legacy format

**Implication:** Suspects use various techniques to hide evidence. Comprehensive forensic analysis must check all possible hiding places.

---

### Finding #2: Deleted Files Remain Recoverable

**Discovery:** All 7 deleted files (2 bearcats, 5 flowers) were successfully recovered from unallocated space.

**Why Deletion Doesn't Mean Erasure:**
When a file is "deleted":
1. File system removes the directory entry
2. Storage blocks are marked as "available"
3. Actual data remains until overwritten
4. File carving can reconstruct files from data blocks

**Modified Timestamp = 0 Analysis:**
This is a reliable indicator of deletion because:
- Normal files have modification timestamps
- Deleted files lose file system metadata
- Timestamp reverts to epoch zero (0)
- Helps distinguish active vs. deleted files

**Forensic Significance:** Even though Bob deleted the flower photos, they were fully recoverable because:
- Deletion was recent (not enough time for overwriting)
- No secure deletion tool was used
- File system didn't zero out the data blocks

---

### Finding #3: Hash Values Prove File Uniqueness

**Challenge:** Three flower images (f0007454.gif, f0002628.bmp, f0009688.png) appeared visually similar.

**Solution:** Calculated and compared MD5 hash values.

**Result:** Different hashes confirmed these were unique files, not duplicates.

**Why This Matters:**
- Prevents counting the same file multiple times
- Proves each file is distinct evidence
- Could represent different photo sessions or edits
- Essential for accurate evidence cataloging

---

### Finding #4: Multi-Volume MacOS Structure

**Observation:** MacOS drive contained 12 volumes (vol0-vol11), but deleted files only found in vol8.

**Analysis:**
This is typical of MacOS file systems because:
- APFS uses volume groups and containers
- Different volumes serve different purposes
- System, user data, and recovery may be separated
- Unallocated space appears in specific volumes

**Lesson Learned:** Must examine ALL volumes in multi-volume systems. Skipping volumes could mean missing critical evidence.

---

### Finding #5: Legacy Format Challenges (PCX)

**Issue:** f0007714.pcx could not be opened with available tools on the forensic workstation.

**Root Cause:** PCX is an obsolete format from the 1980s-1990s, not supported by modern default viewers.

**Solutions:**
1. Install legacy image viewer (XnView, IrfanView)
2. Convert to modern format using ImageMagick: `convert image.pcx image.png`
3. Use online conversion services (in isolated environment)
4. Document as-is and recommend client conversion

**Forensic Lesson:** Old cases or systems may contain legacy file formats. Forensic workstations should maintain compatibility tools for obsolete formats.

---

## üéØ Investigation Results Summary

### Case Objectives Met

| Objective | Status | Details |
|-----------|--------|---------|
| Locate all bearcat images | ‚úÖ Complete | 11 images found across multiple locations |
| Recover deleted flower photos | ‚úÖ Complete | 5 deleted images recovered from MacOS drive |
| Verify evidence integrity | ‚úÖ Complete | MD5 hash verified for primary drive |
| Document all findings | ‚úÖ Complete | Comprehensive report with appendix |

### Evidence Catalog

**Bearcat Images (11 Total):**
1. bearcat.png - Root directory (active)
2. NotanImage.svg - Root directory (active)
3. meeting_notes.eml attachment - Desktop (active)
4. ahhhhhhh - Downloads (active, no extension)
5. cute.tar.xz extracted - Downloads (active, in archive)
6. $CarvedFiles image 1 - Root (deleted, carved)
7. $CarvedFiles image 2 - Root (deleted, carved)
8. .hidden.jpeg - Documents (active, hidden attribute)
9. _D.pedeef embedded - Desktop (active, in PDF)
10. week1.odp embedded - Documents (active, in presentation)
11. Tutorial.mp4 frame - Music (active, video extract)

**Deleted Flower Photos (5 Total):**
1. f0007454.gif - vol8/$CarvedFiles (deleted, GIF format)
2. f0002628.bmp - vol8/$CarvedFiles (deleted, BMP format)
3. f0000575.jpg - vol8/$CarvedFiles (deleted, JPEG format)
4. f0009688.png - vol8/$CarvedFiles (deleted, PNG format)
5. f0007714.pcx - vol8/$CarvedFiles (deleted, PCX format)

---

## üî¨ Advanced Forensic Concepts Applied

### File Carving Technology

**What is File Carving?**
File carving is the process of recovering files from unallocated space without relying on file system metadata. It works by:

1. **File Signature Detection:** Identifying unique byte patterns (magic bytes) that mark the beginning of files
2. **Footer Detection:** Finding patterns that mark the end of files
3. **Size Validation:** Confirming recovered data matches expected file size constraints
4. **Header Validation:** Verifying file structure integrity

**Example - JPEG File Carving:**
```
JPEG Header: FF D8 FF (Start of Image)
JPEG Footer: FF D9 (End of Image)

Carver searches unallocated space for:
FF D8 FF ... [image data] ... FF D9
```

**Tools Used:**
- PhotoRec (integrated with Autopsy)
- Scalpel (alternative carver)
- Foremost (signature-based carver)

**Success Rate Factors:**
- Time since deletion (less overwriting = higher success)
- File fragmentation (contiguous files easier to recover)
- File type (some formats carve better than others)
- Drive usage since deletion

---

### Multi-Source Evidence Correlation

**Challenge:** This investigation required analyzing two separate disk images:
- Primary Linux hard drive
- Secondary MacOS hard drive (embedded within primary)

**Forensic Approach:**
1. Image primary drive first
2. Analyze primary drive completely
3. Discover secondary drive image within primary
4. Mount secondary as additional data source
5. Analyze secondary drive separately
6. Correlate findings across both sources

**Why This Matters:**
Real investigations often involve:
- Multiple computers
- External drives
- Cloud storage
- Mobile devices
- Network shares

Forensic examiners must manage multiple evidence sources while maintaining separate chains of custody.

---

### Timestamp Analysis for Deletion Detection

**Key Indicator: Modified Timestamp = 0**

**What This Means:**
- In Unix/Linux systems, epoch time starts at January 1, 1970, 00:00:00 UTC
- This is represented as timestamp 0
- Deleted files often show timestamp 0 because:
  - File system metadata is wiped
  - Directory entry is removed
  - Timestamp data is lost
  - Only file carving recovers content, not metadata

**Other Timestamp Indicators:**
- **Access Time (atime):** When file was last read
- **Modification Time (mtime):** When file content was last changed
- **Change Time (ctime):** When file metadata was last changed
- **Birth Time (btime):** When file was created (if supported)

**Forensic Analysis:**
```
Active File:
Created: 2024-03-15 10:30:00
Modified: 2024-03-20 14:45:00
Accessed: 2024-03-25 09:15:00

Deleted File:
Created: 0
Modified: 0
Accessed: 0
```

**Conclusion:** Timestamp analysis helps distinguish between:
- Active vs. deleted files
- Recently modified vs. old files
- User access patterns
- File system anomalies

---

### Extension Mismatch Detection

**Purpose:** Identify files with incorrect or misleading extensions.

**Example from Lab:**
- **File:** _D.pedeef
- **Extension Suggests:** Unknown format (.pedeef)
- **Actual Content:** PDF document
- **Detection Method:** File header analysis (magic bytes)

**PDF Magic Bytes:** `%PDF-1.` (starts every PDF file)

**Why Suspects Do This:**
- Hide file type from casual inspection
- Bypass automated filters (email, upload restrictions)
- Confuse file system searches
- Attempt to evade detection

**Forensic Countermeasure:**
Modern forensic tools (like Autopsy) identify files by content, not extension:
1. Read first bytes of file
2. Compare against signature database
3. Flag extension mismatches
4. Report true file type

**Common Mismatch Scenarios:**
- Executables renamed as images (.jpg ‚Üí .exe)
- Documents disguised as text files (.docx ‚Üí .txt)
- Archives hidden as images (.zip ‚Üí .jpg)
- Scripts masked as data files (.js ‚Üí .dat)

---

### Embedded File Extraction Techniques

**Files Within Files:**

Throughout this investigation, bearcat images were found embedded in:
- PDF documents (page 2)
- Presentations (slide 2)
- Email attachments
- Compressed archives
- Video frames

**Extraction Methods:**

**1. PDF Extraction:**
```
PDF Structure:
- Document metadata
- Page objects
- Embedded images (as objects)
- Fonts and resources

Extraction: Open PDF ‚Üí Navigate to image ‚Üí Save separately
```

**2. Archive Extraction:**
```
tar.xz Structure:
- Outer .xz compression layer
- Inner .tar archive
- Contained files

Extraction: tar -xf cute.tar.xz
```

**3. Email Attachment Extraction:**
```
.eml Structure:
- Email headers (From, To, Subject)
- Message body
- MIME-encoded attachments

Extraction: Open in email client ‚Üí Save attachments
```

**4. Video Frame Extraction:**
```
MP4 Structure:
- Container format
- Video track (sequence of frames)
- Audio track
- Metadata

Extraction: Video player ‚Üí Capture frame ‚Üí Export as image
```

**Forensic Significance:**
Suspects often hide files within other files, assuming they won't be examined. Comprehensive forensic analysis requires:
- Recursive file extraction
- Analysis of all container formats
- Examination of embedded objects
- Verification of all nested content

---

## üö® Challenges Encountered & Solutions

### Challenge #1: PCX Format Compatibility

**Problem:** Deleted flower photo f0007714.pcx couldn't be viewed on the forensic workstation.

**Root Cause:** PCX is an obsolete format from the 1980s, no longer supported by default image viewers.

**Immediate Solution:**
- Documented file as recovered
- Noted file header confirms it's an image
- Recorded inability to view with current tools

**Long-term Solutions:**
1. Install legacy image viewer (XnView MP supports PCX)
2. Use ImageMagick for conversion: `convert f0007714.pcx f0007714.png`
3. Maintain forensic workstation with comprehensive format support
4. Keep library of legacy software for old file types

**Lesson Learned:** Forensic workstations should maintain backward compatibility with legacy formats, especially for older cases or systems.

---

### Challenge #2: Distinguishing Visually Similar Images

**Problem:** Three flower photos (f0007454.gif, f0002628.bmp, f0009688.png) looked identical visually.

**Initial Uncertainty:** Are these duplicates or unique files?

**Solution Applied:**
Generated and compared MD5 hash values for each file.

**Results:**
```
f0007454.gif:  [Hash A]
f0002628.bmp:  [Hash B]
f0009688.png:  [Hash C]

Hash A ‚â† Hash B ‚â† Hash C
```

**Conclusion:** All three are unique files despite visual similarity.

**Possible Explanations:**
- Same flower photographed at different times
- Same image saved in different formats
- Different compression levels
- Slight crops or color adjustments
- Different camera settings

**Lesson Learned:** Never rely on visual inspection alone. Hash values provide mathematical proof of file uniqueness.

---

### Challenge #3: Multi-Volume MacOS File System

**Problem:** MacOS drive contained 12 volumes (vol0-vol11). Which ones contain evidence?

**Initial Approach:** Examined vol3 and vol4 first, found active flower photos.

**Issue:** Active photos weren't the target‚Äîneeded DELETED photos.

**Solution:**
- Systematically examined all volumes
- Focused on $CarvedFiles directories
- Found deleted photos in vol8/$CarvedFiles

**Analysis:**
- vol3/vol4: Active flower photos (excluded from report)
- vol8: Deleted flower photos (primary objective)
- Other volumes: System or empty partitions

**Lesson Learned:** 
- Never assume evidence location based on first findings
- Examine ALL volumes in multi-volume systems
- Understand file system structure before drawing conclusions
- Deleted content may be isolated in specific volumes

---

### Challenge #4: Files Without Extensions

**Problem:** File named "ahhhhhhh" in Downloads folder had no extension.

**Question:** What type of file is this?

**Solution:**
Used Autopsy's file type identification (based on magic bytes):
1. Autopsy reads file header
2. Compares against signature database
3. Identifies as image file
4. Allows viewing despite missing extension

**File Header Analysis:**
```
Image file headers:
JPEG: FF D8 FF
PNG:  89 50 4E 47
GIF:  47 49 46 38

Autopsy detected one of these signatures
```

**Lesson Learned:** File extensions are metadata, not identity. True file type is determined by content (file signature/magic bytes).

---

## üìö Real-World Applications

### Corporate Data Recovery Scenario

**Situation:** This lab mirrors a common corporate incident:
- Executive (Bob) accidentally deletes important files
- IT/Forensics team must recover data
- Time-sensitive business need
- Multiple systems involved

**Skills Applied:**
- Quick turnaround forensic imaging
- Deleted file recovery from production systems
- Multi-platform analysis (Linux + MacOS)
- Professional reporting to non-technical stakeholders

**Business Impact:**
Successfully recovering the 5 deleted flower photos demonstrates ability to:
- Restore critical business data
- Minimize operational disruption  
- Prevent data loss incidents
- Provide professional documentation

---

### Legal Investigation Parallels

**Evidence Hiding Techniques Observed:**
This lab demonstrated common evidence concealment methods:
- File compression (archives)
- Embedding in documents
- Extension manipulation
- Hidden file attributes
- File deletion

**Forensic Countermeasures Demonstrated:**
- Comprehensive file system examination
- Signature-based file identification
- Recursive extraction of embedded content
- File carving for deleted evidence
- Hash verification for proof

**Court Admissibility:**
All techniques used follow forensic best practices:
‚úÖ Evidence preserved through imaging  
‚úÖ Chain of custody maintained  
‚úÖ Hash verification documented  
‚úÖ All findings reproducible  
‚úÖ Methods scientifically sound  

---

### Incident Response Application

**Typical IR Scenario:**
- Security breach detected
- Need to determine what data was accessed/stolen
- Suspect may have deleted evidence
- Multiple systems compromised

**Skills from This Lab:**
- Rapid evidence collection (Guymager)
- Comprehensive analysis (Autopsy)
- Deleted file recovery (file carving)
- Multi-source correlation
- Professional reporting

**IR-Specific Considerations:**
- Time-sensitive analysis (business impact)
- Live system imaging (if required)
- Volatile data capture (if applicable)
- Coordination with IT team
- Executive-level reporting

---

## üéì Key Takeaways & Lessons Learned

### Technical Lessons

1. **Deletion ‚â† Erasure**
   - Deleted files remain on disk until overwritten
   - File carving can recover recently deleted files
   - Secure deletion requires specialized tools
   - Timestamp = 0 indicates deletion

2. **File Identity is Content-Based**
   - Extensions can be misleading or missing
   - Magic bytes/file signatures reveal true type
   - Forensic tools identify by content, not name
   - Extension mismatches indicate possible hiding

3. **Files Hide in Many Places**
   - Compressed archives
   - Embedded in documents
   - Email attachments
   - Hidden attributes
   - Video frames
   - Must check all possible containers

4. **Hash Values Prove Uniqueness**
   - Visual similarity doesn't mean identical files
   - Hash comparison provides mathematical proof
   - Essential for evidence cataloging
   - Prevents double-counting duplicates

5. **Multi-Source Investigations are Complex**
   - Separate evidence chains for each source
   - Must examine all volumes/partitions
   - Different file systems require different approaches
   - Correlation across sources reveals full picture

### Forensic Methodology Lessons

1. **Always Image Before Analysis**
   - Preserves original evidence
   - Enables multiple examinations
   - Maintains legal admissibility
   - Protects against accidental modification

2. **Use Multiple Ingest Modules**
   - Automated detection finds more evidence
   - Different modules serve different purposes
   - Comprehensive scanning reduces missed evidence
   - File carving essential for deleted files

3. **Systematic Examination is Critical**
   - Check every folder and volume
   - Don't stop after finding some evidence
   - Follow consistent methodology
   - Document everything discovered

4. **Verify Everything**
   - Hash values for images
   - File type confirmation
   - Timestamp analysis
   - Cross-reference findings

### Professional Skills Developed

1. **Evidence Documentation**
   - Detailed written reports
   - Comprehensive screenshot evidence
   - Organized appendix structure
   - Clear chain of custody

2. **Client Communication**
   - Translated technical findings to business language
   - Addressed specific client needs (Bob's deleted photos)
   - Provided actionable results
   - Professional report presentation

3. **Problem Solving**
   - Overcame PCX format limitation
   - Identified visually similar files as unique
   - Navigated complex multi-volume structure
   - Extracted files from various containers

4. **Tool Proficiency**
   - Guymager for imaging
   - Autopsy for comprehensive analysis
   - Multiple extraction techniques
   - Hash verification methods

---

## üîó References & Additional Resources

### Forensic Tools Documentation
- **Autopsy User Guide:** https://www.sleuthkit.org/autopsy/docs/user-docs/
- **Guymager Documentation:** https://guymager.sourceforge.io/
- **PhotoRec File Carving:** https://www.cgsecurity.org/wiki/PhotoRec

### File Format Specifications
- **Expert Witness Format (E01):** EnCase documentation
- **TAR Archive Format:** GNU tar documentation
- **PCX Format Specification:** ZSoft technical reference

### Forensic Methodologies
- **NIST Computer Forensics Tool Testing:** https://www.nist.gov/itl/ssd/software-quality-group/computer-forensics-tool-testing-program-cftt
- **Digital Forensics Framework:** ACPO Guidelines
- **Chain of Custody Best Practices:** SWGDE standards

### File Signature References
- **File Signatures Database:** Gary Kessler's file signature table
- **Magic Bytes Repository:** File format wiki
- **Format Identification:** PRONOM technical registry

---

## üìä Lab Statistics

**Investigation Summary:**
- **Total Files Examined:** Hundreds across two disk images
- **Evidence Items Recovered:** 16 (11 bearcats + 5 flowers)
- **Deleted Files Carved:** 7 (2 bearcats + 5 flowers)
- **File Formats Analyzed:** 10+ (PNG, JPEG, GIF, BMP, SVG, PCX, PDF, ODP, EML, MP4, TAR.XZ)
- **Disk Images Analyzed:** 2 (Primary Linux drive + MacOS secondary)
- **Volumes Examined:** 12 (MacOS multi-volume structure)
- **Hash Verifications:** Multiple (drive integrity + file uniqueness)

**Time Investment:**
- Evidence Acquisition: ~30 minutes
- Autopsy Analysis: ~2-3 hours
- File Extraction & Documentation: ~1-2 hours
- Report Generation: ~1 hour

**Success Rate:** 100% - All objectives met, all requested evidence recovered

---
